"use strict";(self.webpackChunk_readyplayerme_visage=self.webpackChunk_readyplayerme_visage||[]).push([[22],{"./src/components/Exhibit/Exhibit.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:function(){return Default},_DragNDrop:function(){return _DragNDrop},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return Exhibit_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),services=__webpack_require__("./src/services/index.ts"),FileDropper_component=__webpack_require__("./src/components/FileDropper/FileDropper.component.tsx"),three_module=__webpack_require__("./node_modules/three/build/three.module.js"),Environment_service=__webpack_require__("./src/services/Environment.service.ts"),PresentationControls=__webpack_require__("./node_modules/@react-three/drei/web/PresentationControls.js"),Bounds=__webpack_require__("./node_modules/@react-three/drei/core/Bounds.js"),ContactShadows=__webpack_require__("./node_modules/@react-three/drei/core/ContactShadows.js"),Environment_component=__webpack_require__("./src/components/Scene/Environment.component.tsx"),FloatingModel=__webpack_require__("./src/components/Models/FloatingModel/index.ts"),StaticModel=__webpack_require__("./src/components/Models/StaticModel/index.ts"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),BoundsModelContainer=function BoundsModelContainer(_ref){var modelSrc=_ref.modelSrc,children=_ref.children,fit=_ref.fit,onLoaded=_ref.onLoaded,bounds=(0,Bounds.B)(),_useState=(0,react.useState)((0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})),_useState2=(0,slicedToArray.Z)(_useState,2),fallback=_useState2[0],setFallback=_useState2[1],onChildLoaded=(0,react.useCallback)((function(){fit&&bounds.refresh().clip().fit(),(0,services.DK)(onLoaded)}),[bounds,fit]),childModel=(0,react.useMemo)((function(){return react.Children.map(children,(function(child){return(0,react.cloneElement)(child,{setModelFallback:setFallback,onLoaded:onChildLoaded})}))}),[modelSrc,children,onChildLoaded]);return(0,react.useEffect)((function(){fit&&bounds.refresh().clip().fit()}),[modelSrc,fit,fallback]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:childModel})};BoundsModelContainer.__docgenInfo={description:"",methods:[],displayName:"BoundsModelContainer"};var _Default$parameters,_Default$parameters2,_Default$parameters2$,_DragNDrop$parameters,_DragNDrop$parameters2,_DragNDrop$parameters3,BaseCanvas=__webpack_require__("./src/components/BaseCanvas/index.ts"),Capture_component=__webpack_require__("./src/components/Capture/Capture.component.tsx"),Background=__webpack_require__("./src/components/Background/index.ts"),Exhibit=function Exhibit(_ref){var modelSrc=_ref.modelSrc,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,_ref$environment=_ref.environment,environment=void 0===_ref$environment?"city":_ref$environment,position=_ref.position,style=_ref.style,className=_ref.className,_ref$shadows=_ref.shadows,shadows=void 0!==_ref$shadows&&_ref$shadows,_ref$float=_ref.float,float=void 0!==_ref$float&&_ref$float,_ref$fit=_ref.fit,fit=void 0!==_ref$fit&&_ref$fit,capture=_ref.capture,_ref$snap=_ref.snap,snap=void 0!==_ref$snap&&_ref$snap,_ref$lockVertical=_ref.lockVertical,lockVertical=void 0!==_ref$lockVertical&&_ref$lockVertical,onLoaded=_ref.onLoaded,onLoading=_ref.onLoading,model=(0,react.useMemo)((function(){return(0,services.w9)(modelSrc)?float?(0,jsx_runtime.jsx)(FloatingModel.q,{modelSrc:modelSrc,scale:scale}):(0,jsx_runtime.jsx)(StaticModel.P,{modelSrc:modelSrc,scale:scale}):null}),[float,modelSrc,scale]);return(0,react.useEffect)((function(){return(0,services.DK)(onLoading)}),[modelSrc,onLoading]),(0,jsx_runtime.jsxs)(BaseCanvas.u,{position:position,style:style,className:className,children:[(0,jsx_runtime.jsxs)(react.Suspense,{fallback:null,children:[(0,jsx_runtime.jsx)("ambientLight",{intensity:.5}),(0,jsx_runtime.jsx)("spotLight",{position:[10,10,10],angle:.15,penumbra:1,"shadow-mapSize":[512,512],castShadow:!0}),(0,jsx_runtime.jsx)(PresentationControls.N,{global:!0,config:{mass:2,tension:500},snap:snap,rotation:[0,-.3,0],polar:lockVertical?[0,0]:[-Math.PI/3,Math.PI/3],azimuth:[-1/0,1/0],children:model&&(0,jsx_runtime.jsx)(Bounds.Y,{fit:fit,clip:fit,observe:fit,children:(0,jsx_runtime.jsx)(BoundsModelContainer,{modelSrc:modelSrc,fit:fit,onLoaded:onLoaded,children:model})})}),shadows&&(0,jsx_runtime.jsx)(ContactShadows.j,{position:[0,-1,0],opacity:.75,scale:10,blur:2.6,far:2}),(0,jsx_runtime.jsx)(Environment_component.q,{environment:environment})]}),capture&&(0,jsx_runtime.jsx)(Capture_component.Z,(0,objectSpread2.Z)({},capture)),(null==style?void 0:style.background)&&(0,jsx_runtime.jsx)(Background.l,{color:style.background})]})};Exhibit.__docgenInfo={description:"Interactive presentation of any GLTF (.glb) asset.",methods:[],displayName:"Exhibit",props:{scale:{defaultValue:{value:"1.0",computed:!1},required:!1},environment:{defaultValue:{value:"'city'",computed:!1},required:!1},shadows:{defaultValue:{value:"false",computed:!1},required:!1},float:{defaultValue:{value:"false",computed:!1},required:!1},fit:{defaultValue:{value:"false",computed:!1},required:!1},snap:{defaultValue:{value:"false",computed:!1},required:!1},lockVertical:{defaultValue:{value:"false",computed:!1},required:!1}}};var Default=function Template(args){return(0,jsx_runtime.jsx)(Exhibit,(0,objectSpread2.Z)({},args))}.bind({});Default.args={modelSrc:(0,services.gT)("headwear.glb"),scale:3,environment:"hub",position:new three_module.Vector3(0,1,5),fit:!0,float:!0,shadows:!0,style:{background:"#ccc"},snap:!0,lockVertical:!1,onLoaded:function onLoaded(){return console.info("EVENT: static avatar loaded")},onLoading:function onLoading(){return console.info("EVENT: loading static avatar")}},Default.argTypes={environment:{options:Object.keys(Environment_service.s$),control:{type:"select"}}};var _DragNDrop=function DropTemplate(args){return(0,jsx_runtime.jsx)(FileDropper_component.s,{placeholder:"Drag n' Drop a .glb model here",children:(0,jsx_runtime.jsx)(Exhibit,(0,objectSpread2.Z)({},args))})}.bind({});_DragNDrop.args=(0,objectSpread2.Z)((0,objectSpread2.Z)({},Default.args),{},{onLoaded:function onLoaded(){return console.info("EVENT: static avatar loaded")},onLoading:function onLoading(){return console.info("EVENT: loading static avatar")},position:new three_module.Vector3(0,0,5)}),_DragNDrop.argTypes={modelSrc:{control:!1}};var Exhibit_stories={title:"Components/Exhibit",component:Exhibit,argTypes:{scale:{control:{type:"range",min:.01,max:10,step:.01}}}};Default.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},Default.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_Default$parameters=Default.parameters)||void 0===_Default$parameters?void 0:_Default$parameters.docs),{},{source:(0,objectSpread2.Z)({originalSource:"args => <Exhibit {...args} />"},null===(_Default$parameters2=Default.parameters)||void 0===_Default$parameters2||null===(_Default$parameters2$=_Default$parameters2.docs)||void 0===_Default$parameters2$?void 0:_Default$parameters2$.source)})}),_DragNDrop.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},_DragNDrop.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_DragNDrop$parameters=_DragNDrop.parameters)||void 0===_DragNDrop$parameters?void 0:_DragNDrop$parameters.docs),{},{source:(0,objectSpread2.Z)({originalSource:'args => <FileDropper placeholder="Drag n\' Drop a .glb model here">\n    <Exhibit {...args} />\n  </FileDropper>'},null===(_DragNDrop$parameters2=_DragNDrop.parameters)||void 0===_DragNDrop$parameters2||null===(_DragNDrop$parameters3=_DragNDrop$parameters2.docs)||void 0===_DragNDrop$parameters3?void 0:_DragNDrop$parameters3.source)})});var __namedExportsOrder=["Default","_DragNDrop"]},"./src/components/FileDropper/FileDropper.component.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{s:function(){return FileDropper}});var regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),FileDropper_module_fileDropContainer="FileDropper_fileDropContainer__-KZmt",FileDropper_module_placeholder="FileDropper_placeholder__zVZlo",jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),FileDropper=function FileDropper(_ref){var children=_ref.children,_ref$placeholder=_ref.placeholder,placeholder=void 0===_ref$placeholder?"Drag n' Drop a .glb model here, then Drop an animation .glb or .fbx":_ref$placeholder,ref=(0,react.useRef)(null),_useState=(0,react.useState)(""),_useState2=(0,slicedToArray.Z)(_useState,2),modelSrc=_useState2[0],setModelSrc=_useState2[1],_useState3=(0,react.useState)(""),_useState4=(0,slicedToArray.Z)(_useState3,2),animationSrc=_useState4[0],setAnimationSrc=_useState4[1],getBase64=function getBase64(file){return new Promise((function(resolve,reject){var reader=new FileReader;reader.readAsDataURL(file),reader.onload=function(){return resolve(reader.result)},reader.onerror=function(error){return reject(error)}}))},handleDrag=function handleDrag(e){e.preventDefault(),e.stopPropagation()},handleDragIn=function handleDragIn(e){e.preventDefault(),e.stopPropagation()},handleDragOut=function handleDragOut(e){e.preventDefault(),e.stopPropagation()},handleDrop=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(e){var _e$dataTransfer,_name,_name2,file;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(e.preventDefault(),e.stopPropagation(),"file"!==(null===(_e$dataTransfer=e.dataTransfer)||void 0===_e$dataTransfer?void 0:_e$dataTransfer.items[0].kind)){_context.next=18;break}if(file=e.dataTransfer.items[0].getAsFile(),null!==(_name=file.name)&&void 0!==_name&&_name.endsWith(".glb")||null!==(_name2=file.name)&&void 0!==_name2&&_name2.endsWith(".fbx")){_context.next=6;break}return _context.abrupt("return");case 6:if(""!==modelSrc){_context.next=12;break}return _context.t0=setModelSrc,_context.next=10,getBase64(file);case 10:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 12:if(""===modelSrc){_context.next=18;break}return _context.t2=setAnimationSrc,_context.next=16,getBase64(file);case 16:_context.t3=_context.sent,(0,_context.t2)(_context.t3);case 18:case"end":return _context.stop()}}),_callee)})));return function handleDrop(_x){return _ref2.apply(this,arguments)}}();return(0,react.useEffect)((function(){var element=ref.current;return element.addEventListener("dragenter",handleDragIn),element.addEventListener("dragleave",handleDragOut),element.addEventListener("dragover",handleDrag),element.addEventListener("drop",handleDrop),function(){element.removeEventListener("dragenter",handleDragIn),element.removeEventListener("dragleave",handleDragOut),element.removeEventListener("dragover",handleDrag),element.removeEventListener("drop",handleDrop)}})),(0,jsx_runtime.jsx)("div",{className:FileDropper_module_fileDropContainer,ref:ref,children:modelSrc.length<1?(0,jsx_runtime.jsx)("div",{className:FileDropper_module_placeholder,children:placeholder}):react.Children.map(react.Children.toArray(children),(function(child){return(0,react.cloneElement)(child,{modelSrc:modelSrc,animationSrc:animationSrc})}))})};FileDropper.__docgenInfo={description:"This component is only for using in Storybook for showcasing drag'n'drop functionality.",methods:[],displayName:"FileDropper",props:{placeholder:{defaultValue:{value:"`Drag n' Drop a .glb model here, then Drop an animation .glb or .fbx`",computed:!1},required:!1}}}}}]);