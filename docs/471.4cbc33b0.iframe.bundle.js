"use strict";(self.webpackChunk_readyplayerme_visage=self.webpackChunk_readyplayerme_visage||[]).push([[471],{"./src/components/Avatar/index.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{q:function(){return Avatar_component},b:function(){return CAMERA}});var controls,objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),three_module=__webpack_require__("./node_modules/three/build/three.module.js"),index_673ef987_esm=__webpack_require__("./node_modules/@react-three/fiber/dist/index-673ef987.esm.js"),OrbitControls=__webpack_require__("./node_modules/three-stdlib/controls/OrbitControls.js"),services=__webpack_require__("./src/services/index.ts"),progress=Number.POSITIVE_INFINITY,CameraLighting=function CameraLighting(_ref){var cameraTarget=_ref.cameraTarget,cameraInitialDistance=_ref.cameraInitialDistance,cameraZoomTarget=_ref.cameraZoomTarget,_ref$headScale=_ref.headScale,headScale=void 0===_ref$headScale?1:_ref$headScale,ambientLightColor=_ref.ambientLightColor,ambientLightIntensity=_ref.ambientLightIntensity,dirLightPosition=_ref.dirLightPosition,dirLightColor=_ref.dirLightColor,dirLightIntensity=_ref.dirLightIntensity,spotLightPosition=_ref.spotLightPosition,spotLightColor=_ref.spotLightColor,spotLightAngle=_ref.spotLightAngle,spotLightIntensity=_ref.spotLightIntensity,_ref$controlsMinDista=_ref.controlsMinDistance,controlsMinDistance=void 0===_ref$controlsMinDista?.4:_ref$controlsMinDista,_ref$controlsMaxDista=_ref.controlsMaxDistance,controlsMaxDistance=void 0===_ref$controlsMaxDista?2.5:_ref$controlsMaxDista,_ref$updateCameraTarg=_ref.updateCameraTargetOnZoom,updateCameraTargetOnZoom=void 0!==_ref$updateCameraTarg&&_ref$updateCameraTarg,cameraZoomTargetRef=(0,react.useRef)(cameraZoomTarget),_useThree=(0,index_673ef987_esm.z)(),camera=_useThree.camera,gl=_useThree.gl,scene=_useThree.scene,fallbackCameraTarget=cameraTarget||1.475+headScale/10,headScaleAdjustedMinDistance=controlsMinDistance+headScale/10;return(0,react.useEffect)((function(){var _cameraZoomTargetRef$,_cameraZoomTargetRef$2,_cameraZoomTargetRef$3;return(null===(_cameraZoomTargetRef$=cameraZoomTargetRef.current)||void 0===_cameraZoomTargetRef$?void 0:_cameraZoomTargetRef$.x)===(null==cameraZoomTarget?void 0:cameraZoomTarget.x)&&(null===(_cameraZoomTargetRef$2=cameraZoomTargetRef.current)||void 0===_cameraZoomTargetRef$2?void 0:_cameraZoomTargetRef$2.y)===(null==cameraZoomTarget?void 0:cameraZoomTarget.y)&&(null===(_cameraZoomTargetRef$3=cameraZoomTargetRef.current)||void 0===_cameraZoomTargetRef$3?void 0:_cameraZoomTargetRef$3.z)===(null==cameraZoomTarget?void 0:cameraZoomTarget.z)||(cameraZoomTargetRef.current=cameraZoomTarget,progress=0),(controls=new OrbitControls.z(camera,gl.domElement)).enableRotate=!1,controls.enablePan=!1,controls.minDistance=headScaleAdjustedMinDistance,controls.maxDistance=controlsMaxDistance,controls.minPolarAngle=1.4,controls.maxPolarAngle=1.4,controls.target.set(0,fallbackCameraTarget,0),controls.update(),cameraInitialDistance&&progress===Number.POSITIVE_INFINITY&&(camera.position.z=cameraInitialDistance,controls.update()),function(){controls.dispose()}}),[cameraInitialDistance,camera,controlsMinDistance,controlsMaxDistance,fallbackCameraTarget,gl.domElement,headScaleAdjustedMinDistance,cameraZoomTarget]),(0,react.useEffect)((function(){if(scene.getObjectByName("back-highlight")){var _dirLight=scene.getObjectByName("back-highlight");_dirLight.color.set(dirLightColor),_dirLight.intensity=dirLightIntensity,_dirLight.position.set(dirLightPosition.x,dirLightPosition.y,dirLightPosition.z);var _ambientLight=scene.getObjectByName("ambient-light");_ambientLight.color.set(ambientLightColor),_ambientLight.intensity=ambientLightIntensity;var _spotLight=scene.getObjectByName("spot-light");_spotLight.color.set(spotLightColor),_spotLight.intensity=spotLightIntensity,_spotLight.angle=spotLightAngle,_spotLight.position.set(spotLightPosition.x,spotLightPosition.y,spotLightPosition.z)}else{var dirLight=new three_module.DirectionalLight(dirLightColor,dirLightIntensity);dirLight.name="back-highlight",dirLight.position.set(dirLightPosition.x,dirLightPosition.y,dirLightPosition.z),dirLight.castShadow=!0,dirLight.shadow.bias=-1e-4,dirLight.shadow.mapSize.height=1024,dirLight.shadow.mapSize.width=1024,dirLight.shadow.blurSamples=100;var ambientLight=new three_module.AmbientLight(ambientLightColor,ambientLightIntensity);ambientLight.name="ambient-light",ambientLight.position.set(0,0,0);var spotLight=new three_module.SpotLight(spotLightColor,spotLightIntensity,0,spotLightAngle,0,1);spotLight.name="spot-light",spotLight.position.set(spotLightPosition.x,spotLightPosition.y,spotLightPosition.z),camera.add(ambientLight),camera.add(spotLight),camera.add(dirLight),scene.add(camera)}}),[ambientLightColor,ambientLightIntensity,dirLightPosition,dirLightColor,dirLightIntensity,spotLightPosition,spotLightColor,spotLightIntensity,spotLightAngle,camera,scene]),(0,index_673ef987_esm.A)((function(_,delta){updateCameraTargetOnZoom&&function updateCameraTarget(camera,target,minDistance,maxDistance){if(controls){var distance=controls.target.distanceTo(camera.position),pivot=((distance=(0,services.uZ)(distance,maxDistance,minDistance))-minDistance)/(maxDistance-minDistance);controls.target.set(0,target-.6*pivot,0)}}(camera,fallbackCameraTarget,headScaleAdjustedMinDistance,controlsMaxDistance),function updateCameraFocus(camera,delta,target){target&&progress<=1&&(camera.position.setX((0,services.t7)(camera.position.x,target.x,progress)),camera.position.setZ((0,services.t7)(camera.position.z,target.z,progress)),progress+=delta)}(camera,delta,cameraZoomTarget),controls&&controls.update()})),null},Environment_component=__webpack_require__("./src/components/Scene/Environment.component.tsx"),BaseCanvas=__webpack_require__("./src/components/BaseCanvas/index.ts"),Models=__webpack_require__("./src/components/Models/index.ts"),dist=__webpack_require__("./node_modules/@react-three/postprocessing/dist/index.js"),esm_react=__webpack_require__("./node_modules/jotai/esm/react.mjs"),Capture_component=__webpack_require__("./src/components/Capture/Capture.component.tsx"),Box_component=__webpack_require__("./src/components/Background/Box/Box.component.tsx"),Background=__webpack_require__("./src/components/Background/index.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),Shadow=function Shadow(){return(0,jsx_runtime.jsx)("group",{position:[0,0,0],children:(0,jsx_runtime.jsxs)("mesh",{receiveShadow:!0,position:[0,0,0],"rotation-x":-Math.PI/2,children:[(0,jsx_runtime.jsx)("planeGeometry",{attach:"geometry",args:[3,2]}),(0,jsx_runtime.jsx)("shadowMaterial",{attach:"material",transparent:!0,opacity:.2})]},"shadow-catcher")})};Shadow.__docgenInfo={description:"",methods:[],displayName:"Shadow"};var Shadow_component=Shadow,Loader_module_loader="Loader_loader__DwtSp",Loader_module_dots="Loader_dots__2HwYS",Loader_module_dot="Loader_dot__8Tb8I",Loader=function Loader(){return(0,jsx_runtime.jsx)("div",{className:Loader_module_loader,children:(0,jsx_runtime.jsx)("div",{className:Loader_module_dots,children:[1,2,3].map((function(it){return(0,jsx_runtime.jsx)("div",{className:Loader_module_dot},it)}))})})};Loader.__docgenInfo={description:"",methods:[],displayName:"Loader"};var components_Loader=Loader,Bloom=function Bloom(_ref){var _ref$luminanceThresho=_ref.luminanceThreshold,luminanceThreshold=void 0===_ref$luminanceThresho?1:_ref$luminanceThresho,_ref$luminanceSmoothi=_ref.luminanceSmoothing,luminanceSmoothing=void 0===_ref$luminanceSmoothi?1:_ref$luminanceSmoothi,_ref$mipmapBlur=_ref.mipmapBlur,mipmapBlur=void 0===_ref$mipmapBlur||_ref$mipmapBlur,_ref$intensity=_ref.intensity,intensity=void 0===_ref$intensity?.1:_ref$intensity,_ref$kernelSize=_ref.kernelSize,kernelSize=void 0===_ref$kernelSize?0:_ref$kernelSize;return(0,jsx_runtime.jsx)(dist.dp,{luminanceThreshold:luminanceThreshold,luminanceSmoothing:luminanceSmoothing,mipmapBlur:mipmapBlur,intensity:intensity,kernelSize:kernelSize})};Bloom.__docgenInfo={description:"",methods:[],displayName:"Bloom",props:{luminanceThreshold:{defaultValue:{value:"1",computed:!1},required:!1},luminanceSmoothing:{defaultValue:{value:"1",computed:!1},required:!1},mipmapBlur:{defaultValue:{value:"true",computed:!1},required:!1},intensity:{defaultValue:{value:"0.1",computed:!1},required:!1},kernelSize:{defaultValue:{value:"0",computed:!1},required:!1}}};var Bloom_component=Bloom,build=__webpack_require__("./node_modules/postprocessing/build/index.js"),spawnAtom=__webpack_require__("./src/state/spawnAtom.ts"),CAMERA={TARGET:{FULL_BODY:{MALE:1.65,FEMALE:1.55},HALF_BODY:.6},INITIAL_DISTANCE:{FULL_BODY:.4,HALF_BODY:.5},CONTROLS:{FULL_BODY:{MIN_DISTANCE:.5,MAX_DISTANCE:3.2,ZOOM_TARGET:new three_module.Vector3(-.11,0,3.2)},HALF_BODY:{MIN_DISTANCE:.4,MAX_DISTANCE:1.4,ZOOM_TARGET:new three_module.Vector3(-.15,0,.55)}}},Avatar=function Avatar(_ref){var _effects$bloom,_effects$bloom2,_effects$bloom3,_effects$bloom4,_effects$bloom5,modelSrc=_ref.modelSrc,_ref$animationSrc=_ref.animationSrc,animationSrc=void 0===_ref$animationSrc?void 0:_ref$animationSrc,_ref$poseSrc=_ref.poseSrc,poseSrc=void 0===_ref$poseSrc?void 0:_ref$poseSrc,_ref$environment=_ref.environment,environment=void 0===_ref$environment?"city":_ref$environment,_ref$halfBody=_ref.halfBody,halfBody=void 0!==_ref$halfBody&&_ref$halfBody,_ref$shadows=_ref.shadows,shadows=void 0!==_ref$shadows&&_ref$shadows,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,_ref$ambientLightColo=_ref.ambientLightColor,ambientLightColor=void 0===_ref$ambientLightColo?"#fff5b6":_ref$ambientLightColo,_ref$ambientLightInte=_ref.ambientLightIntensity,ambientLightIntensity=void 0===_ref$ambientLightInte?.25:_ref$ambientLightInte,_ref$dirLightPosition=_ref.dirLightPosition,dirLightPosition=void 0===_ref$dirLightPosition?new three_module.Vector3(-3,5,-5):_ref$dirLightPosition,_ref$dirLightColor=_ref.dirLightColor,dirLightColor=void 0===_ref$dirLightColor?"#002aff":_ref$dirLightColor,_ref$dirLightIntensit=_ref.dirLightIntensity,dirLightIntensity=void 0===_ref$dirLightIntensit?5:_ref$dirLightIntensit,_ref$spotLightPositio=_ref.spotLightPosition,spotLightPosition=void 0===_ref$spotLightPositio?new three_module.Vector3(12,10,7.5):_ref$spotLightPositio,_ref$spotLightColor=_ref.spotLightColor,spotLightColor=void 0===_ref$spotLightColor?"#fff5b6":_ref$spotLightColor,_ref$spotLightAngle=_ref.spotLightAngle,spotLightAngle=void 0===_ref$spotLightAngle?.314:_ref$spotLightAngle,_ref$spotLightIntensi=_ref.spotLightIntensity,spotLightIntensity=void 0===_ref$spotLightIntensi?1:_ref$spotLightIntensi,_ref$cameraTarget=_ref.cameraTarget,cameraTarget=void 0===_ref$cameraTarget?CAMERA.TARGET.FULL_BODY.MALE:_ref$cameraTarget,_ref$cameraInitialDis=_ref.cameraInitialDistance,cameraInitialDistance=void 0===_ref$cameraInitialDis?CAMERA.INITIAL_DISTANCE.FULL_BODY:_ref$cameraInitialDis,style=_ref.style,emotion=_ref.emotion,_ref$idleRotation=_ref.idleRotation,idleRotation=void 0!==_ref$idleRotation&&_ref$idleRotation,capture=_ref.capture,background=_ref.background,onLoaded=_ref.onLoaded,onLoading=_ref.onLoading,dpr=_ref.dpr,className=_ref.className,_ref$headMovement=_ref.headMovement,headMovement=void 0!==_ref$headMovement&&_ref$headMovement,_ref$cameraZoomTarget=_ref.cameraZoomTarget,cameraZoomTarget=void 0===_ref$cameraZoomTarget?CAMERA.CONTROLS.FULL_BODY.ZOOM_TARGET:_ref$cameraZoomTarget,onLoadedEffect=_ref.onLoadedEffect,onLoadedAnimation=_ref.onLoadedAnimation,children=_ref.children,effects=_ref.effects,_ref$fov=_ref.fov,fov=void 0===_ref$fov?50:_ref$fov,setSpawnState=(0,esm_react.b9)(spawnAtom.O);(0,react.useEffect)((function(){setSpawnState({onLoadedEffect:onLoadedEffect,onLoadedAnimation:onLoadedAnimation})}),[onLoadedAnimation,onLoadedEffect,setSpawnState]);var AvatarModel=(0,react.useMemo)((function(){return(0,services.w9)(modelSrc)?animationSrc&&!halfBody&&(0,services.w9)(animationSrc)?(0,jsx_runtime.jsx)(Models.sb,{emotion:emotion,modelSrc:modelSrc,animationSrc:animationSrc,scale:scale,idleRotation:idleRotation,onLoaded:onLoaded,headMovement:headMovement,bloom:null==effects?void 0:effects.bloom}):halfBody?(0,jsx_runtime.jsx)(Models.T9,{emotion:emotion,modelSrc:modelSrc,scale:scale,idleRotation:idleRotation,onLoaded:onLoaded,headMovement:headMovement,bloom:null==effects?void 0:effects.bloom}):(0,services.w9)(poseSrc)?(0,jsx_runtime.jsx)(Models.dn,{emotion:emotion,modelSrc:modelSrc,scale:scale,poseSrc:poseSrc,onLoaded:onLoaded,bloom:null==effects?void 0:effects.bloom}):(0,jsx_runtime.jsx)(Models.Pn,{modelSrc:modelSrc,scale:scale,onLoaded:onLoaded,emotion:emotion,bloom:null==effects?void 0:effects.bloom}):null}),[halfBody,animationSrc,modelSrc,scale,poseSrc,idleRotation,emotion,onLoaded,headMovement,null==effects?void 0:effects.bloom]);return(0,react.useEffect)((function(){return(0,services.DK)(onLoading)}),[modelSrc,animationSrc,onLoading]),(0,jsx_runtime.jsxs)(BaseCanvas.u,{position:new three_module.Vector3(0,0,3),fov:fov,style:style,dpr:dpr,className:className,children:[(0,jsx_runtime.jsx)(Environment_component.q,{environment:environment}),(0,jsx_runtime.jsx)(CameraLighting,{cameraTarget:cameraTarget,cameraInitialDistance:cameraInitialDistance,cameraZoomTarget:cameraZoomTarget,ambientLightColor:ambientLightColor,ambientLightIntensity:ambientLightIntensity,dirLightPosition:dirLightPosition,dirLightColor:dirLightColor,dirLightIntensity:dirLightIntensity,spotLightPosition:spotLightPosition,spotLightColor:spotLightColor,spotLightAngle:spotLightAngle,spotLightIntensity:spotLightIntensity,controlsMinDistance:halfBody?CAMERA.CONTROLS.HALF_BODY.MIN_DISTANCE:CAMERA.CONTROLS.FULL_BODY.MIN_DISTANCE,controlsMaxDistance:halfBody?CAMERA.CONTROLS.HALF_BODY.MAX_DISTANCE:CAMERA.CONTROLS.FULL_BODY.MAX_DISTANCE,updateCameraTargetOnZoom:!halfBody}),AvatarModel,children,shadows&&(0,jsx_runtime.jsx)(Shadow_component,{}),(null==background?void 0:background.src)&&(0,jsx_runtime.jsx)(Box_component.x,(0,objectSpread2.Z)({},background)),capture&&(0,jsx_runtime.jsx)(Capture_component.Z,(0,objectSpread2.Z)({},capture)),(null==background?void 0:background.color)&&(0,jsx_runtime.jsx)(Background.l,{color:background.color}),((null==effects?void 0:effects.ambientOcclusion)||(null==effects?void 0:effects.bloom))&&(0,jsx_runtime.jsx)(dist.xC,{autoClear:!0,multisampling:4,children:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(null==effects?void 0:effects.ambientOcclusion)&&(0,jsx_runtime.jsx)(dist.K,{blendFunction:build.YQ.MULTIPLY,distanceScaling:!1,radius:.09,bias:.02,intensity:3,samples:23,worldDistanceThreshold:24,worldDistanceFalloff:0,worldProximityThreshold:0,worldProximityFalloff:6,fade:.02,rings:16}),(null==effects?void 0:effects.bloom)&&(0,jsx_runtime.jsx)(Bloom_component,{luminanceThreshold:null==effects||null===(_effects$bloom=effects.bloom)||void 0===_effects$bloom?void 0:_effects$bloom.luminanceThreshold,luminanceSmoothing:null==effects||null===(_effects$bloom2=effects.bloom)||void 0===_effects$bloom2?void 0:_effects$bloom2.luminanceSmoothing,intensity:null==effects||null===(_effects$bloom3=effects.bloom)||void 0===_effects$bloom3?void 0:_effects$bloom3.intensity,kernelSize:null==effects||null===(_effects$bloom4=effects.bloom)||void 0===_effects$bloom4?void 0:_effects$bloom4.kernelSize,mipmapBlur:null==effects||null===(_effects$bloom5=effects.bloom)||void 0===_effects$bloom5?void 0:_effects$bloom5.mipmapBlur})]})})]})},AvatarWrapper=function AvatarWrapper(props){var _props$loader;return(0,jsx_runtime.jsx)(react.Suspense,{fallback:null!==(_props$loader=props.loader)&&void 0!==_props$loader?_props$loader:(0,jsx_runtime.jsx)(components_Loader,{}),children:(0,jsx_runtime.jsx)(esm_react.zt,{children:(0,jsx_runtime.jsx)(Avatar,(0,objectSpread2.Z)({},props))})})};AvatarWrapper.__docgenInfo={description:"",methods:[],displayName:"AvatarWrapper",props:{modelSrc:{required:!0,tsType:{name:"union",raw:"string | Blob",elements:[{name:"string"},{name:"Blob"}]},description:"Arbitrary binary data (base64 string, Blob) of a `.glb` file or path (URL) to a `.glb` resource."},animationSrc:{required:!1,tsType:{name:"union",raw:"string | Blob",elements:[{name:"string"},{name:"Blob"}]},description:"Arbitrary binary data (base64 string, Blob) of a `.glb|.fbx` file or path (URL) to a `.glb|.fbx` resource.\nThe animation will be run for the 3D model provided in `modelSrc`."},poseSrc:{required:!1,tsType:{name:"union",raw:"string | Blob",elements:[{name:"string"},{name:"Blob"}]},description:"Arbitrary binary data (base64 string, Blob) or a path (URL) to `.glb` file which will be used to map Bone placements onto the underlying 3D model.\nApplied when not specifying an animation."},halfBody:{required:!1,tsType:{name:"boolean"},description:""},shadows:{required:!1,tsType:{name:"boolean"},description:"Enable rendering shadows on ground."},scale:{required:!1,tsType:{name:"number"},description:"Size of the rendered GLB model."},cameraTarget:{required:!1,tsType:{name:"number"},description:"Camera target on Y-axis."},cameraInitialDistance:{required:!1,tsType:{name:"number"},description:"Initial Z-axis distance from the object upon render."},style:{required:!1,tsType:{name:"CSSProperties"},description:"Apply styling to canvas DOM element.\nNote that background property can not be set via style prop, it will always be overridden to `transparent`.\nInstead, use `background` prop for that purpose."},idleRotation:{required:!1,tsType:{name:"boolean"},description:"Applies an idle rotation to the animated and half-body models."},emotion:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"number"}],raw:"Record<string, number>"},description:"Applies a face emotion of the model."},background:{required:!1,tsType:{name:"Background"},description:"Allows adding a background image and background color to the scene.\nMake sure that image is loadable to prevent bg errors.\nbackground.src - Accepts URL string.\nbackground.color - Accepts Hexadeximal, RGB, X11 color name, HSL string, doesn't support CSS gradients."},capture:{required:!1,tsType:{name:"CaptureType"},description:"Return base64 image after making screenshot of the canvas."},loader:{required:!1,tsType:{name:"ReactNode"},description:"Pass custom fallback component."},dpr:{required:!1,tsType:{name:"Dpr"},description:"Device Pixel Ratio."},className:{required:!1,tsType:{name:"string"},description:"Custom style classes for canvas."},headMovement:{required:!1,tsType:{name:"boolean"},description:"Enable head tracking cursor movements."},cameraZoomTarget:{required:!1,tsType:{name:"Vector3"},description:"Initialise and update camera movement on Z-Axis.\nDefaults to full-body zoom distance."},onLoadedEffect:{required:!1,tsType:{name:"SpawnState['onLoadedEffect']",raw:"SpawnState['onLoadedEffect']"},description:"Spawn effect when model is loaded into scene."},onLoadedAnimation:{required:!1,tsType:{name:"SpawnState['onLoadedAnimation']",raw:"SpawnState['onLoadedAnimation']"},description:"Spawn animation when model is loaded into scene."},fov:{required:!1,tsType:{name:"number"},description:"Field of view of the camera."},effects:{required:!1,tsType:{name:"EffectConfiguration"},description:"Control some effects like post-processing effects"},children:{required:!1,tsType:{name:"ReactNode"},description:"Use any three.js(fiber, post-processing) compatible components to render in the scene."}},composes:["LightingProps","EnvironmentProps","Omit"]};var Avatar_component=AvatarWrapper},"./src/components/Models/index.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{sb:function(){return AnimationModelContainer},R8:function(){return EnvironmentModelContainer},T9:function(){return HalfBodyModelContainer},dn:function(){return PoseModelContainer},Pn:function(){return StaticModel.P}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),index_673ef987_esm=__webpack_require__("./node_modules/@react-three/fiber/dist/index-673ef987.esm.js"),three_module=__webpack_require__("./node_modules/three/build/three.module.js"),Model=__webpack_require__("./src/components/Models/Model/index.ts"),services=__webpack_require__("./src/services/index.ts"),Animation_service=__webpack_require__("./src/services/Animation.service.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),currentRotation=0,AnimationModel=function AnimationModel(_ref){var modelSrc=_ref.modelSrc,animationSrc=_ref.animationSrc,_ref$rotation=_ref.rotation,rotation=void 0===_ref$rotation?Math.PI/180*20:_ref$rotation,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,_ref$idleRotation=_ref.idleRotation,idleRotation=void 0!==_ref$idleRotation&&_ref$idleRotation,setModelFallback=_ref.setModelFallback,onLoaded=_ref.onLoaded,_ref$headMovement=_ref.headMovement,headMovement=void 0!==_ref$headMovement&&_ref$headMovement,emotion=_ref.emotion,bloom=_ref.bloom,ref=(0,react.useRef)(null),_useState=(0,react.useState)(!0),_useState2=(0,slicedToArray.Z)(_useState,2),animationRunning=_useState2[0],setAnimationRunning=_useState2[1],scene=(0,services.Jr)(modelSrc).scene,nodes=(0,index_673ef987_esm.C)(scene).nodes,animationClip=(0,react.useMemo)((0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",(0,Animation_service.$)(animationSrc));case 1:case"end":return _context.stop()}}),_callee)}))),[animationSrc]),animationMixer=(0,react.useMemo)((0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){var mixer,animation;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(mixer=new three_module.AnimationMixer(nodes.Armature),!animationRunning){_context2.next=3;break}return _context2.abrupt("return",mixer);case 3:return _context2.t0=mixer,_context2.next=6,animationClip;case 6:return _context2.t1=_context2.sent,(animation=_context2.t0.clipAction.call(_context2.t0,_context2.t1)).fadeIn(0),animation.play(),mixer.update(0),_context2.abrupt("return",mixer);case 12:case"end":return _context2.stop()}}),_callee2)}))),[animationRunning,animationClip,nodes.Armature]);return(0,index_673ef987_esm.A)(function(){var _ref4=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(state,delta){var _yield$animationMixer;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,animationMixer;case 2:if(_context3.t1=_yield$animationMixer=_context3.sent,_context3.t0=null===_context3.t1,_context3.t0){_context3.next=6;break}_context3.t0=void 0===_yield$animationMixer;case 6:if(!_context3.t0){_context3.next=10;break}_context3.next=11;break;case 10:_yield$animationMixer.update(delta);case 11:if(idleRotation){_context3.next=13;break}return _context3.abrupt("return");case 13:null!=ref&&ref.current&&(currentRotation+=.2*delta,ref.current.rotation.y=rotation+Math.sin(currentRotation)/3);case 14:case"end":return _context3.stop()}}),_callee3)})));return function(_x,_x2){return _ref4.apply(this,arguments)}}()),(0,services.bx)({nodes:nodes,enabled:headMovement}),(0,services.Kx)(nodes,emotion),(0,services.FB)("blink",nodes),(0,services.xD)(nodes,setModelFallback),(0,jsx_runtime.jsx)(Model.H,{modelRef:ref,scene:scene,scale:scale,onLoaded:onLoaded,onSpawnAnimationFinish:function onSpawnAnimationFinish(){setAnimationRunning(!1)},bloom:bloom})};AnimationModel.__docgenInfo={description:"",methods:[],displayName:"AnimationModel",props:{rotation:{defaultValue:{value:"20 * (Math.PI / 180)",computed:!1},required:!1},scale:{defaultValue:{value:"1",computed:!1},required:!1},idleRotation:{defaultValue:{value:"false",computed:!1},required:!1},headMovement:{defaultValue:{value:"false",computed:!1},required:!1}}};var AnimationModelContainer=function AnimationModelContainer(props){var _useState=(0,react.useState)((0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})),_useState2=(0,slicedToArray.Z)(_useState,2),fallback=_useState2[0],setFallback=_useState2[1];return(0,jsx_runtime.jsx)(react.Suspense,{fallback:fallback,children:(0,jsx_runtime.jsx)(AnimationModel,(0,objectSpread2.Z)({setModelFallback:setFallback},props))})};AnimationModelContainer.__docgenInfo={description:"Contains model to handle suspense fallback.",methods:[],displayName:"AnimationModelContainer"};__webpack_require__("./src/components/Models/FloatingModel/index.ts");var HalfBodyModel_component_currentRotation=0,HalfBodyModel=function HalfBodyModel(_ref){var modelSrc=_ref.modelSrc,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,_ref$rotation=_ref.rotation,rotation=void 0===_ref$rotation?Math.PI/180*20:_ref$rotation,_ref$idleRotation=_ref.idleRotation,idleRotation=void 0!==_ref$idleRotation&&_ref$idleRotation,emotion=_ref.emotion,setModelFallback=_ref.setModelFallback,onLoaded=_ref.onLoaded,_ref$headMovement=_ref.headMovement,headMovement=void 0!==_ref$headMovement&&_ref$headMovement,bloom=_ref.bloom,ref=(0,react.useRef)(null),scene=(0,services.Jr)(modelSrc).scene,nodes=(0,index_673ef987_esm.C)(scene).nodes;return scene.traverse((function(object){var node=object;"Wolf3D_Hands"===node.name&&(node.visible=!1),"RightHand"===node.name&&node.position.set(0,-2,0),"LeftHand"===node.name&&node.position.set(0,-2,0)})),(0,index_673ef987_esm.A)((function(state,delta){idleRotation&&null!=ref&&ref.current&&(HalfBodyModel_component_currentRotation+=.2*delta,ref.current.rotation.y=rotation+Math.sin(HalfBodyModel_component_currentRotation)/3)})),(0,services.bx)({nodes:nodes,isHalfBody:!0,enabled:headMovement}),(0,services.FB)("blink",nodes),(0,services.Kx)(nodes,emotion),(0,services.xD)(nodes,setModelFallback),(0,jsx_runtime.jsx)(Model.H,{modelRef:ref,scene:scene,scale:scale,onLoaded:onLoaded,bloom:bloom})};HalfBodyModel.__docgenInfo={description:"",methods:[],displayName:"HalfBodyModel",props:{scale:{defaultValue:{value:"1",computed:!1},required:!1},rotation:{defaultValue:{value:"20 * (Math.PI / 180)",computed:!1},required:!1},idleRotation:{defaultValue:{value:"false",computed:!1},required:!1},headMovement:{defaultValue:{value:"false",computed:!1},required:!1}}};var HalfBodyModelContainer=function HalfBodyModelContainer(props){var _useState=(0,react.useState)((0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})),_useState2=(0,slicedToArray.Z)(_useState,2),fallback=_useState2[0],setFallback=_useState2[1];return(0,jsx_runtime.jsx)(react.Suspense,{fallback:fallback,children:(0,jsx_runtime.jsx)(HalfBodyModel,(0,objectSpread2.Z)({setModelFallback:setFallback},props))})};HalfBodyModelContainer.__docgenInfo={description:"Contains model to handle suspense fallback.",methods:[],displayName:"HalfBodyModelContainer"};var StaticModel=__webpack_require__("./src/components/Models/StaticModel/index.ts"),PoseModel=function PoseModel(_ref){var modelSrc=_ref.modelSrc,poseSrc=_ref.poseSrc,modelRef=_ref.modelRef,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,emotion=_ref.emotion,setModelFallback=_ref.setModelFallback,onLoaded=_ref.onLoaded,bloom=_ref.bloom,scene=(0,services.Jr)(modelSrc).scene,nodes=(0,index_673ef987_esm.C)(scene).nodes,pose=(0,services.Jr)(poseSrc),sourceNodes=(0,index_673ef987_esm.C)(pose.scene).nodes;return(0,services.bu)(nodes,sourceNodes),(0,services.Kx)(nodes,emotion),(0,services.xD)(nodes,setModelFallback),(0,jsx_runtime.jsx)(Model.H,{modelRef:modelRef,scene:scene,scale:scale,onLoaded:onLoaded,bloom:bloom})};PoseModel.__docgenInfo={description:"",methods:[],displayName:"PoseModel",props:{scale:{defaultValue:{value:"1",computed:!1},required:!1}}};var PoseModelContainer=function PoseModelContainer(props){var _useState=(0,react.useState)((0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})),_useState2=(0,slicedToArray.Z)(_useState,2),fallback=_useState2[0],setFallback=_useState2[1];return(0,jsx_runtime.jsx)(react.Suspense,{fallback:fallback,children:(0,jsx_runtime.jsx)(PoseModel,(0,objectSpread2.Z)({setModelFallback:setFallback},props))})};PoseModelContainer.__docgenInfo={description:"Contains model to handle suspense fallback.",methods:[],displayName:"PoseModelContainer"};var Environment_service=__webpack_require__("./src/services/Environment.service.ts"),EnvironmentModel=function EnvironmentModel(_ref){var environment=_ref.environment,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,setModelFallback=_ref.setModelFallback,onLoaded=_ref.onLoaded,transform=new services.wx,scene=(0,services.Jr)(environment).scene,nodes=(0,index_673ef987_esm.C)(scene).nodes;return(0,services.xD)(nodes,setModelFallback),(0,react.useEffect)((function(){return(0,services.DK)(onLoaded)}),[scene,onLoaded]),(0,jsx_runtime.jsx)("group",{children:Object.keys(nodes).map((function(key){var node=nodes[key];return"Mesh"===node.type?(0,jsx_runtime.jsx)("mesh",{receiveShadow:!0,scale:scale,position:transform.position,rotation:transform.rotation,geometry:node.geometry,material:node.material,morphTargetInfluences:node.morphTargetInfluences||[]},node.name):null}))})};EnvironmentModel.__docgenInfo={description:"",methods:[],displayName:"EnvironmentModel",props:{scale:{defaultValue:{value:"1",computed:!1},required:!1}}};var EnvironmentModelContainer=function EnvironmentModelContainer(props){var _useState=(0,react.useState)((0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})),_useState2=(0,slicedToArray.Z)(_useState,2),fallback=_useState2[0],setFallback=_useState2[1],environment=props.environment,environmentSrc=environment in Environment_service.om?Environment_service.om[environment]:environment;return(0,jsx_runtime.jsx)(react.Suspense,{fallback:fallback,children:(0,jsx_runtime.jsx)(EnvironmentModel,(0,objectSpread2.Z)((0,objectSpread2.Z)({setModelFallback:setFallback},props),{},{environment:environmentSrc}))})};EnvironmentModelContainer.__docgenInfo={description:"Contains model to handle suspense fallback.",methods:[],displayName:"EnvironmentModelContainer"}}}]);